## 一、背景
大学排名是一个非常重要同时也极富挑战性与争议性的问题，一所大学的综合实力涉及科研、师资、学生等方方面面。目前全球有上百家评估机构会评估大学的综合得分进行排序，而这些机构的打分也往往并不一致。在这些评分机构中，世界大学排名中心（Center for World University Rankings，缩写CWUR）以评估教育质量、校友就业、研究成果和引用，而非依赖于调查和大学所提交的数据著称，是非常有影响力的一个。

本数据来自 Kaggle 的[数据](https://www.kaggle.com/mylesoneill/world-university-rankings?select=cwurData.csv)，构建「线性回归」模型，根据大学各项指标的排名预测综合得分。


## 二、任务

本任务中我们将根据 CWUR 所提供的世界各地知名大学各方面的排名（师资、科研等），一方面通过数据可视化的方式观察不同大学的特点，另一方面希望构建机器学习模型（线性回归）预测一所大学的综合得分。


## 三、评价指标
**基本要求：**
* 按照 8:2 随机划分训练集测试集，用 RMSE 作为评价指标，得到测试集上线性回归模型的 RMSE 值；
* 对线性回归模型的系数进行分析。

**扩展要求：**
* 对数据进行观察与可视化，展示数据特点；
* 尝试其他的回归模型，对比效果；
* 尝试将离散的地区特征融入线性回归模型，并对结果进行对比。



## 四、模型训练过程及结果
* 本次实验数据集来自Trec06的中文垃圾邮件数据集，目录解压后包含三个文件夹，其中data目录下是所有的邮件（未分词），已分词好的邮件在data_cut目录下。邮件分为邮件头部分和正文部分，两部分之间一般有空行隔开。标签数据在label文件夹下，文件中每行是标签和对应的邮件路径。‘spam’表示垃圾邮件，‘ham’表示正常邮件。  
* 识别垃圾邮件已经很很多前人的经验：需要大样本的训练集，我们已经具备；不能忽略邮件头，我们打算对加不加入邮件头作个对比；只使用最显著的少数的词，我们打算对比词表大小对结果的影响。  
* 模型差异主要来自于特征的提取方式不同和分布时的所做的假设不同。提取方式考虑CountVectorizer和TfidfVectorizer；所做的假设不同考虑多项式朴素贝叶斯分类器（MultinomialNB）, 伯努利朴素贝叶斯分类器（BernoulliNB), 补码朴素贝叶斯分类器（ComplementNB)，高斯贝叶斯分类器（GaussianNB）。
* 针对垃圾邮件识别，假阳性的代价远高于假阴性。因此，模型评价上，在accuracy和recall满足“大于0.9”的基础上，我们选择优先选择precision最好的值。再考虑其它参数。

#### 详见 train.ipynb

## 五、结果汇总
* 从特征工程和结果上看，本数据集并不适合线性回归。
* 加入地区后，有微小提升，区域偏见还是有体现，但还算相对可信。
* 空数据的补全，本数据中没什么意义。
<div style="text-align:center">

|        方法 | 去除空数据 | 独热编码 | 补缺 |
|----------|----------|----------|----------|
|最小二乘法                   | 1.9620 | 1.9419 | 2.9976|
|梯度下降法                   | 3.9379 | 3.8896 | 5.9945|
|sklearn-线性回归             | 3.9241 | 3.8839 | 5.9953|
|sklearn-多项式回归           | 1.6833 | - | 2.5986|

</div>

---
---
## 环境参考：

| model | version |
|----------|----------|
| python                    | 3.10.13 |
| matplotlib                | 3.4.3 |
| matplotlib-inline         | 0.1.6 |
| numpy                     | 1.22.3 |
| pandas                    | 1.5.3 |
| python-dateutil           | 2.8.2 |
| scikit-learn              | 1.3.0 |
| seaborn                   | 0.12.2 |
| torch                     | 2.1.2 |
| torchaudio                | 2.1.2 |
| torchvision               | 0.16.2 |
| ydata-profiling           | 0.0.dev0 |
